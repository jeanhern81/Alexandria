<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="icon" type="image/png" href="../images/Alexandria-symbol.png" />
	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="../css/materialize.css" />
	<link rel="stylesheet" href="../css/mainsStyles.css" />
	<link rel="stylesheet" href="../css/properties.css" />
	<script src="../js/materialize.js"></script>

	<!--Google Fonts-->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
	<!--Font Awesome-->
	<script src="https://kit.fontawesome.com/8b8f26d0e1.js" crossorigin="anonymous"></script>
	<!-- Jquery -->
	<script src="https://code.jquery.com/jquery-3.5.1.js"
		integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
	<style>
		/* Set the size of the div element that contains the map */
		#map {
			height: 400px;
			/* The height is 400 pixels */
			width: 100%;
			/* The width is the width of the web page */
		}
	</style>

	<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDHRCqL8yZbKNEZl7PFCmbA_XlaIBluHZ8&callback=initMap"></script>
	<!-- custom js -->
	<!-- <script src="../js/app.js"></script> -->
	<!-- Font Nunito from google -->
	<link
		href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,600;1,700;1,800;1,900&display=swap"
		rel="stylesheet" />

	<title>Alexandria | Properties</title>
</head>

<body>
	<!-- Beginning of NavBar -->

	<div class="navbar-fixed fontSize">
		<nav class="teal lighten-2">
			<div class="nav-wrapper">
				<!-- <a href="../../index.html" class="brand-logo"><img id="alexandria-logo" src="../images/Alexandria-logo-BW.png" width="200px" length="100px" ></a> -->
				<!-- <a href="../../index.html" data-target="mobile-demo" class="sidenav-trigger" ><i class="material-icons">menu</i></a > -->
				<ul class="left hide-on-med-and-down">
					<li>
						<a href="../../index.html"><img id="alexandria-logo" src="../images/Alexandria-logo-BW.png"
								width="250px" length="125px" /></a>
					</li>
					<li>
						<a class="dropdown-trigger" href="#" data-target="dropdown1">Properties<i
								class="material-icons right">arrow_drop_down</i></a>
					</li>
					<li><a href="#">Maps</a></li>
					<li><a href="#">Dashboard</a></li>
					<!-- Save for Later. DO NOT DELETE <li><a href="mobile.html">Mobile</a></li>-->
				</ul>
			</div>
			<!-- Dropdown Structure -->
			<ul id="dropdown1" class="dropdown-content">
				<li><a href="#!">one</a></li>
				<li><a href="#!">two</a></li>
				<li class="divider"></li>
				<li><a href="#!">three</a></li>
			</ul>
		</nav>
		<ul class="sidenav" id="mobile-demo">
			<li class="active"><a href="#">Properties</a></li>
			<li><a href="#">Maps</a></li>
			<li><a href="#">Dashboard</a></li>
			<!-- Save for Later. DO NOT DELETE <li><a href="mobile.html">Mobile</a></li>-->
		</ul>
		<div id="nav-image">
			<img src="../images/backgrounds/houses.jpg" width="100%" />

		</div>
	</div>
	<!-- End of NavBar -->

		<!-- Beginning of Heading -->
		<div class="property-body">
			<h5 id="property-header">PROPERTIES</h5>
			<!-- Beginning of Property listings. This Section will need to be dynamic with JS. -->
			<!-- Propertery #1 - Just a place holder-->
			<div class="row">
				<!-- This section would populate address once user inputs information and it is stored in localStorage -->
				<div class="col s12"><h6>1790 WEST ARROW ROUTE, UPLAND, CA</h6></div>
				<div class="col s3"> <span class="teal-text text-lighten-2">Rent</span> <h6></h6></div>
				<div class="col s3"> <span class="teal-text text-lighten-2">Expenses</span> </div>
				<section class="property-buttons">
					<div class="col s3"> <a class="waves-effect waves-light btn-large" ><i class="material-icons center">build</i></a > </div>
					<div class="col s3"> <a class="waves-effect waves-light btn-large" ><i class="medium material-icons">monetization_on</i></a > </div>
				</section>
			</div>
		</div>

	<!-- add property modal -->
	<div id="addProperties" class="modal modal-fixed-footer">
		<div class="modal-content">
			<div class="row">

				<div class="col s12 main center">
					<h1>Add Properties</h1>
				</div>
			</div>
			</header>

			<br />
			<div class="container">
				<form id="Property">
					<label for="street address">Street Address</label>
					<input type="text" id="streetAddress" />
					<br />
					<label for="city"> City </label>
					<input type="text" id="city" />
					<br />
					<label for="state">State</label>
					<input type="text" id="state" />
					<br />
					<label for="expenses">Monthly Expenses</label>
					<input type="text" id="expenses" />
					<br />
					<label for="rent">Monthly Rent</label>
					<input type="text" id="rent" />
					<br />
					<div class="row">
						<a href="#!"><button class="col offset-s4 btn waves-effect waves-light modal-close"
								type="submit" id="addProperty">
								Add Property
							</button></a>
					</div>
				</form>
			</div>
		</div>

	</div>
	<div id="propertyMap" class="modal modal-fixed-footer">
		<div class="modal-content">
			<div class="row">
				<div class="col s12 main center" id="mapTitle">

				</div>
			</div>
			</header>

			<br />
			<div class="container">
				<div id="map"></div>

			</div>
		</div>


	</div>
	</div>
	<div class="row">

		<div class="col s12 center-align">
			<a class="waves-effect waves-light btn-large modal-trigger" href="#addProperties"><i
					class="medium material-icons">add</i></a>

		</div>
	</div>
	<script>

		document.addEventListener('DOMContentLoaded', function () {
			var elems = document.querySelectorAll('.modal');
			var instances = M.Modal.init(elems);
		});
	</script>
	<script>

		document.addEventListener('DOMContentLoaded', function () {
			var elem = document.getElementById('#propertyMap');
			var instance = M.Modal.init(elem);
		});
	</script>

	<!-- End of Property listings -->
	<script>
		// function to get properties from local storage object
		$(document).ready(function () {

			getFromLocal();


			// function to add properties to local storage

			var arr = [];

			// this event takes the inputs from the add property form fields creates variables from them and passes them into the getLatLong function to return latitude and longitude fro google maps api
			$("#addProperty").on("click", function (event) {
				event.preventDefault();

				var addressVal = $("#streetAddress").val().trim();
				var cityVal = $("#city").val().trim();
				var stateVal = $("#state").val().trim();
				var expensesVal = $("#expenses").val().trim();
				var rentVal = $("#rent").val().trim();
				// pushes address and info as an object into the arr array

				if (localStorage.getItem("addresses") != undefined) {
					arr = JSON.parse(localStorage.getItem("addresses"));
					arr.push({
						address: addressVal,
						city: cityVal,
						state: stateVal,
						expenses: expensesVal,
						rent: rentVal,
					});
				} else {
					arr.push({
						address: addressVal,
						city: cityVal,
						state: stateVal,
						expenses: expensesVal,
						rent: rentVal,
					});
				}
				// converts the arr array into json and stores it in local storage for use in the properties page
				localStorage.setItem("addresses", JSON.stringify(arr));
				location.reload(true);
				getFromLocal();

			});
			// 
			function getFromLocal() {
				// checks if addresses object in local storage exists
				if (localStorage.getItem("addresses") != undefined) {

					// if address object does exist this pulls the object and saves it as a variable
					var addressArr = JSON.parse(localStorage.getItem("addresses"));
					// for loop runs through addressArr and dynamically builds out properties
					for (i = 0; i < addressArr.length; i++) {
						// builds out property div
						var propertyDiv = $("<div class='row'> ");
						var propertyDivStyle = $("<div class='col s12'>");
						var address = $("<h6 class='propAdd'>").text(
							addressArr[i].address.toUpperCase() +
							" " +
							addressArr[i].city.toUpperCase() +
							" " +
							addressArr[i].state.toUpperCase()
						);
						// builds out rent display
						var rentDiv = $("<div class='col s3'>");
						var rentStyle = $("<span class='teal-text text-lighten-2'>");

						rentDiv.append(rentStyle);
						rentStyle.text("Monthly Rent: " + addressArr[i].rent);
						// builds out expense display
						var expenseDiv = $("<div class='col s3'>");
						var expenseStyle = $("<span class='teal-text text-lighten-2'>");

						expenseDiv.append(expenseStyle);
						expenseStyle.text("Monthly Expenses: " + addressArr[i].expenses);
						// builds out wrench icon
						var workIconDiv = $("<div class='col s2'>");
						var workLink = $("<a class='waves-effect waves-light btn-large'>");
						var workIcon = $("<i class='material-icons center'>");

						workIconDiv.append(workLink);
						workLink.append(workIcon);
						workIcon.text("build");
						// builds out money icon
						var moneyIconDiv = $("<div class='col s2'>");
						var moneyLink = $("<a class='waves-effect waves-light btn-large'>");
						var moneyIcon = $("<i class='material-icons center'>");

						moneyIconDiv.append(moneyLink);
						moneyLink.append(moneyIcon);
						moneyIcon.text("monetization_on");

						// builds out map icon
						var mapIconDiv = $("<div class='col s2'>");
						var mapLink = $("<a class='waves-effect waves-light btn-large modal-trigger' href='#propertyMap'>");
						var mapIcon = $("<i class='material-icons center'>");

						mapIconDiv.append(mapLink).on("click", function () {
							getLatLong($(this).siblings()[0].textContent)

							// var mapTextH6 = $("<h6>")
							// $("#mapTitle").append(mapTextH6)
							// mapTextH6.text($(this).siblings()[0].textContent)


						})
						mapLink.append(mapIcon)
						mapIcon.text("map")



						// appends property to body
						propertyDivStyle.append(address);
						propertyDiv.append(propertyDivStyle);
						propertyDiv.append(rentDiv);
						propertyDiv.append(expenseDiv);
						propertyDiv.append(workIconDiv);
						propertyDiv.append(moneyIconDiv);
						propertyDiv.append(mapIconDiv)
						$(".property-body").append(propertyDiv);
					}
				}
			}
			function getLatLong(a) {
				var queryURL =
					"https://maps.googleapis.com/maps/api/geocode/json?address=" +
					a +
					"&key=AIzaSyDHRCqL8yZbKNEZl7PFCmbA_XlaIBluHZ8";
				$.ajax({
					url: queryURL,
					method: "GET",
				}).then(function (response) {
					var address = response.results[0].geometry.location;
					console.log(address);
					initMap(address);

					// console.log(response.results[0].geometry);
					// var latLon = response.results[0].geometry.location;
					// returnLocation(latLon);
					// callback(latlon);
				});
			}
			function initMap(mark) {
				// The location of Uluru
				var address = mark;
				// The map, centered at Uluru
				var map = new google.maps.Map(document.getElementById("map"), {
					zoom: 13,
					center: address,
				});
				// The marker, positioned at Uluru
				var marker = new google.maps.Marker({ position: address, map: map });
			}


		})

		</script>
    <script src="../js/property.js"></script>


		<!--Footer -->
		<footer class="page-footer teal lighten-2">
			<!-- Need to center it and add some padding through html or css -->
			© 2020 Alexandria. All rights reserved.
		</footer>
	
		<!-- Compiled and minified JavaScript -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
		<script src="../js/property.js"></script>
	</body>
</html>

